"use strict";

var Html = require("utils/html");
var proto = require("utils/proto");

function HR(out) {
	this.out = out;
	this.html = Html.create(out);
}

proto(HR, function ok() {
	this.out.writeHead(200, {
		"content-type": "text/html"
	});

}, function html5() {
	var html = this.html;

	html.raw("<!DOCTYPE html>");
	html.open("html");
	html.open("head");
	html.put("meta");
	html.attr("charset", "utf-8");

}, function title(str) {
	var html = this.html;

	html.open("title");
	html.text(str);
	html.close();

}, function body() {
	var html = this.html;

	html.closeTo("head");
	html.open("body");

}, function render(f) {
	var args = [this.html];
	var i = 1;

	while (i < arguments.length) {
		args[i] = arguments[i];

		i += 1;
	}

	f.apply(undefined, args);

}, function end() {
	this.html.end();
	this.out.end();
});

exports.create = function (out) {
	return new HR(out);
};
